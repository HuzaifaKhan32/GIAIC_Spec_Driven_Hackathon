/* --- Custom Variables based on Tailwind Config --- */
:root {
    /* Colors */
    --color-primary: #3c3cf6;
    --color-background-light: #f5f5f8;
    --color-widget-bg-light: #ffffff; /* Default for light mode */
    --color-widget-border-light: #e2e8f0; /* slato-200 */
    --color-text-light: #0f172a; /* slate-900 */
    
    /* Shared Dark Mode Colors */
    --color-background-dark: #101022;
    --color-widget-bg-dark: rgba(30, 41, 59, 0.8); /* #1E293B/80 */
    --color-widget-border-dark: rgba(255, 255, 255, 0.1); /* white/10 */
    --color-header-bg-dark: rgba(30, 41, 59, 1); /* #1E293B */
    --color-text-dark: #ffffff;
    --color-secondary-text-dark: #9c9cba;
    --color-input-bg-dark: #0F172A; /* slate-900 */
    --color-ai-bubble-bg-dark: #334155; /* slate-700 */
  
    /* Fonts */
    --font-display: 'Space Grotesk', sans-serif;
    
    /* Spacing & Radii */
    --radius-lg: 1rem;
    --radius-xl: 1.5rem;
    --transition-speed: 0.3s;
  }
  
  /* Dark Mode Overrides */
  [data-theme='dark'] {
    --color-background: var(--color-background-dark);
    --color-text: var(--color-text-dark);
    --color-widget-bg: var(--color-widget-bg-dark);
    --color-widget-border: var(--color-widget-border-dark);
    --color-input-bg: var(--color-input-bg-dark);
  }
  
  /* Light Mode Defaults */
  :not([data-theme='dark']) {
    --color-background: var(--color-background-light);
    --color-text: var(--color-text-light);
    --color-widget-bg: var(--color-widget-bg-light);
    --color-widget-border: var(--color-widget-border-light);
    --color-header-bg-light: var(--color-widget-bg-light); /* Assuming white header in light mode */      
    --color-input-bg: #f8fafc; /* slate-50 */
  }
  
  /* --- Container & FAB --- */
  .chatbotContainer {
    /* absolute bottom-4 right-4 z-50 */
    position: fixed;
    bottom: 20px; /* 4 units */
    right: 24px;
    z-index: 1000;
    transition: all var(--transition-speed) ease-in-out;
    font-family: var(--font-display);
  }
  
  .chatbotFab {
    /* absolute bottom-4 right-4 */
    position: absolute;
    bottom: 0;
    right: 0;
  }
  
  .fabButton {
    /* flex h-16 w-16 cursor-pointer items-center justify-center rounded-full 
       bg-gradient-to-br from-[#A78BFA] to-pink-500 text-white 
       shadow-lg shadow-primary/40 transition-transform hover:scale-110 */
    display: flex;
    height: 4rem; /* h-16 */
    width: 4rem; /* w-16 */
    font-size: 25px;
    cursor: pointer;
    align-items: center;
    justify-content: center;
    border-radius: 9999px; /* rounded-full */
    border: none;
    color: white;
    
    /* Gradient */
    background: linear-gradient(90deg, #3B82F6, #8B5CF6, #06B6D4); 
    
    /* Shadow */
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1), 0 10px 15px -3px rgba(60, 60, 246, 0.4); /* shadow-lg shadow-primary/40 */
    
    transition: transform 0.2s ease-in-out;
  }
  
  .fabButton:hover {
    transform: scale(1.1);
  }
  
  .fabButton .material-symbols-outlined {
    font-size: 2rem; /* text-3xl */
  }
  
  /* --- Chat Panel --- */
  .chatPanel {
    /* absolute bottom-24 right-4 flex w-[400px] h-[600px] max-h-[calc(100vh-8rem)] 
       flex-col overflow-hidden rounded-xl border border-white/10 
       bg-[#1E293B]/80 shadow-2xl shadow-primary/20 backdrop-blur-xl */
    position: absolute;
    bottom: 5rem; /* bottom-24 (96px) */
    right: 0;
    width: 400px;
    height: 600px;
    max-height: calc(100vh - 8rem); 
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border-radius: var(--radius-xl); /* rounded-xl (1.5rem) */
    
    /* Default light mode styles (will be hidden if not open) */
    background-color: var(--color-widget-bg-light); 
    border: 1px solid var(--color-widget-border-light); 
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); /* shadow-2xl */
    
    /* Dark Mode Styles */
    [data-theme='dark'] & {
      background-color: var(--color-widget-bg-dark);
      border: 1px solid var(--color-widget-border-dark);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 40px rgba(60, 60, 246, 0.2); /* shadow-2xl shadow-primary/20 */
      backdrop-filter: blur(12px); /* backdrop-blur-xl */
    }
  
    /* Animation */
    opacity: 0;
    transform: scale(0.9) translate(0, 20px);
    pointer-events: none;
    transition: opacity var(--transition-speed) ease-out, transform var(--transition-speed) ease-out;     
  }
  
  .chatbotContainer.open .chatPanel {
    opacity: 1;
    transform: scale(1) translate(0, 0);
    pointer-events: all;
  }
  
  /* --- Panel Header --- */
  .chatHeader {
    /* flex items-center justify-between border-b border-white/10 p-4 */
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 16px; /* p-4 */
    flex-shrink: 0;
    
    /* Light Mode */
    border-bottom: 1px solid #e2e8f0;
    background-color: var(--color-header-bg-light);
  
    /* Dark Mode */
    [data-theme='dark'] & {
      border-bottom: 1px solid var(--color-widget-border-dark);
      background-color: #1E293B; /* Specific header background for dark mode */
    }
  }
  
  .headerInfo {
    /* flex items-center gap-4 */
    display: flex;
    align-items: center;
    gap: 10px; /* gap-4 */
  }
  
  .avatarWrapper {
    /* relative */
    position: relative;
  }
  
  .aiAvatar {
    /* bg-center bg-no-repeat aspect-square bg-cover rounded-full h-10 w-10 */
    height: 2.5rem; /* h-10 */
    width: 2.5rem; /* w-10 */
    border-radius: 9999px; /* rounded-full */
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
    flex-shrink: 0;
  }
  
  .onlineIndicator {
    /* absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-[#1E293B] bg-green-500 */
    position: absolute;
    bottom: 0;
    right: 0;
    height: 0.75rem; /* h-3 */
    width: 0.75rem; /* w-3 */
    border-radius: 9999px; /* rounded-full */
    border: 2px solid #1E293B;
    background-color: #22c55e; /* green-500 */
  }
  
  .headerText {
    /* flex flex-col */
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    /* flex-direction: column; */
  }
  
  .headerTitle {
    /* text-white text-base font-bold leading-tight */
    font-size: 1rem; /* text-base */
    font-weight: 700; /* font-bold */
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    /* Light Mode */
    color: var(--color-text-light);
  
    /* Dark Mode */
    [data-theme='dark'] & {
      color: var(--color-text-dark);
    }
  }
  
  .headerSubtitle {
    /* text-xs font-normal leading-normal text-[#9c9cba] */
    font-size: 0.75rem; /* text-xs */
    font-weight: 400; /* font-normal */
     /* leading-normal */
    
    /* Light Mode */
    color: #64748b; /* slate-500 */
  
    /* Dark Mode */
    [data-theme='dark'] & {
      color: var(--color-secondary-text-dark);
    }
  }
  
  .headerActions {
    /* flex items-center gap-2 */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem; /* gap-2 */
  }
  
  .headerActionButton {
    /* text-slate-400 hover:text-white transition-colors */
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.25rem;
    font-size: 20px;
    /* Light Mode */
    color: #94a3b8; /* slate-400 */
    
    /* Dark Mode */
    [data-theme='dark'] & {
      color: #94a3b8; /* slate-400 */
    }
  
    transition: color var(--transition-speed);
  }
  
  .headerActionButton:hover {
    /* Light Mode */
    color: #334155; /* slate-700 */
  
    /* Dark Mode */
    [data-theme='dark'] & {
      color: var(--color-text-dark); /* white */
    }
  }
  
  .headerActionButton .material-symbols-outlined {
    font-size: 1.25rem; /* text-xl */
  }
  
  /* --- Messages Area (This is what ChatUI should contain) --- */
  /* The ChatUI component is where the flex-1 space-y-4 overflow-y-auto p-4 logic goes. */
  /* Assuming this component uses the class chatbotMessages for the scrollable container. */
  
  .chatbotMessages {
    /* flex-1 space-y-4 overflow-y-auto p-4 */
    flex: 1 1 0%; /* flex-1 */
    overflow-y: auto;
    padding: 1rem; /* p-4 */
    display: flex;
    flex-direction: column;
    gap: 1rem; /* space-y-4 */
  
    /* Light Mode Background */
    background-color: var(--color-background-light);
  
    /* Dark Mode Background */
    [data-theme='dark'] & {
      background-color: transparent; /* Allows backdrop-blur from panel to show */
    }
  }
  
  /* --- Input Area (Footer) --- */
  .chatInputArea {
    /* border-t border-white/10 p-4 */
    padding: 1rem; /* p-4 */
    flex-shrink: 0;
    
    /* Light Mode */
    border-top: 1px solid #e2e8f0;
    background-color: var(--color-widget-bg-light);
  
    /* Dark Mode */
    [data-theme='dark'] & {
      border-top: 1px solid var(--color-widget-border-dark);
      background-color: #1E293B; /* Specific background for footer */
    }
  }
  
  .inputWrapper {
    /* flex items-center gap-2 rounded-lg bg-[#0F172A] p-1 
       focus-within:ring-2 focus-within:ring-[#A78BFA] */
    display: flex;
    align-items: center;
    gap: 0.5rem; /* gap-2 */
    border-radius: 0.5rem; /* rounded-lg */
    padding: 0.25rem; /* p-1 */
    border: 1px solid transparent; /* default border */
    
    /* Light Mode */
    background-color: #f1f5f9; /* slate-100 */
  
    /* Dark Mode */
    [data-theme='dark'] & {
      background-color: transparent;
      border: 1px solid white;
    }
  }
  
  .inputWrapper:focus-within {
    /* focus-within:ring-2 focus-within:ring-[#A78BFA] */
    box-shadow: 0 0 0 2px #a78bfa;
  }
  
  .inputField {
    /* flex-1 bg-transparent px-3 py-2 text-sm text-white placeholder:text-slate-500 
       focus:outline-none border-0 focus:ring-0 */
    flex: 1 1 0%; /* flex-1 */
    background-color: transparent;
    padding: 0.5rem 0.75rem; /* px-3 py-2 */
    font-size: 0.875rem; /* text-sm */
    
    /* Light Mode */
    color: var(--color-text-light);
    
    /* Dark Mode */
    [data-theme='dark'] & {
      color: var(--color-text-dark);
      &::placeholder {
        color: #64748b; /* placeholder:text-slate-500 */
      }
    }
  
    border: 0;
    outline: none;
  }
  
  .sendButton {
    /* flex items-center justify-center rounded-md 
       bg-gradient-to-br from-[#06B6D4] to-[#3B82F6] 
       p-2 text-white transition-opacity hover:opacity-90 */
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.375rem; /* rounded-md */
    padding: 0.5rem; /* p-2 */
    color: white;
    border: none;
    cursor: pointer;
    
    /* Gradient */
    background: linear-gradient(to bottom right, #06b6d4, #3b82f6);
    
    transition: opacity 0.2s ease-in-out;
  }
  
  .sendButton:hover {
    opacity: 0.9;
  }
  
  .sendButton .material-symbols-outlined {
    font-size: 1.25rem; /* text-xl */
  }
  
  /* --- Message Bubbles (For use inside ChatUI) --- */
  
  .messageBubble {
    /* Shared styles */
    padding: 0.5rem 0.75rem; /* px-3 py-2 */
    font-size: 0.875rem; /* text-sm */
    line-height: 1.5; /* leading-normal */
    border-radius: 0.5rem; /* rounded-lg */
    max-width: 20rem; /* max-w-xs (320px) - Tailwind's default */
  }
  
  .aiMessageContainer {
    /* flex gap-3 */
    display: flex;
    gap: 0.75rem; /* gap-3 */
  }
  
  .aiAvatarSmall {
    /* size-10 shrink-0 */
    width: 2.5rem; /* size-10 */
    height: 2.5rem;
    flex-shrink: 0;
    border-radius: 9999px;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
  }
  
  .aiMessageBubble {
    /* flex flex-col gap-2 rounded-lg rounded-tl-none bg-[#334155] p-3 text-white border-l-2 border-[#22D3EE] */
    background-color: #334155;
    color: white;
    border-top-left-radius: 0; /* rounded-tl-none */
    border-left: 2px solid #22d3ee;
  }
  
  .aiCitationButton {
    /* inline-block align-middle ml-1 px-2 py-0.5 text-xs font-medium rounded-full 
       bg-gradient-to-r from-[#A78BFA] to-[#3B82F6] text-white hover:opacity-90 */
    display: inline-block;
    vertical-align: middle;
    margin-left: 0.25rem; /* ml-1 */
    padding: 0.125rem 0.5rem; /* px-2 py-0.5 */
    font-size: 0.75rem; /* text-xs */
    font-weight: 500; /* font-medium */
    border-radius: 9999px; /* rounded-full */
    color: white;
    border: none;
    cursor: pointer;
    
    /* Gradient */
    background: linear-gradient(to right, #a78bfa, #3b82f6);
    
    transition: opacity 0.2s ease-in-out;
  }
  
  .aiCitationButton:hover {
    opacity: 0.9;
  }
  
  .userMessageContainer {
    /* flex justify-end items-start gap-3 */
    display: flex;
    justify-content: flex-end;
    align-items: flex-start;
    gap: 0.75rem; /* gap-3 */
  }
  
  .userMessageBubble {
    /* max-w-xs rounded-lg bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6] px-3 py-2 text-white */
    color: white;
    
    /* Gradient */
    background: linear-gradient(to right, #3b82f6, #8b5cf6);
  }
  
  /* --- Typing Indicator --- */
  .typingIndicator {
    /* flex items-center space-x-1.5 rounded-lg bg-[#334155] p-3 */
    display: flex;
    align-items: center;
    gap: 0.375rem; /* space-x-1.5 */
    border-radius: 0.5rem; /* rounded-lg */
    background-color: #334155;
    padding: 0.75rem; /* p-3 */
  }
  
  .dot {
    /* h-2 w-2 rounded-full bg-gradient-to-r from-[#06B6D4] to-[#3B82F6] */
    height: 0.5rem; /* h-2 */
    width: 0.5rem; /* w-2 */
    border-radius: 9999px; /* rounded-full */
    background: linear-gradient(to right, #06b6d4, #3b82f6);
    animation: pulse 1.5s ease-in-out infinite;
  }
  
  /* Animation delays from Tailwind structure */
  .dot:nth-child(2) {
    animation-delay: 0.2s;
  }
  
  .dot:nth-child(3) {
    animation-delay: 0.4s;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
  
  /* --- Mobile Responsiveness (max-width: 500px) --- */
  @media (max-width: 500px) {
    .chatbotContainer {
      bottom: 0; /* 10px */
      right: 0; /* 10px */
    }
  
    .chatPanel {
      width: 100vw;
      height: 100vh;
      bottom: 0;
      right: 0;
      border-radius: 0;
      box-shadow: none;
      max-height: 100vh; /* Subtract mobile browser header size */
      z-index: 1000;
    }
    .chatbotFab{
      bottom: 0.5rem;
      right: 0.5rem;
    }
  }
  /* --- Messages Area Scrollbar Control --- */

/* For WebKit browsers (Chrome, Safari, newer Edge) */
.chatbotMessages::-webkit-scrollbar {
    width: 0 !important; /* Hides the vertical scrollbar */
    height: 0 !important; /* Hides the horizontal scrollbar */
    display: none; /* Secondary hide for older versions */
  }

  /* For Firefox */
  .chatbotMessages {
    scrollbar-width: none; /* Hides the scrollbar in Firefox */
    -ms-overflow-style: none; /* Hides the scrollbar in IE and old Edge */
    overflow-y: scroll; /* Ensures scrolling is still possible */
  }
